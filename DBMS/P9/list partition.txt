SET SERVEROUTPUT ON;

// Q1 //
CREATE TABLE STUDENT (
SID VARCHAR2 (10) NOT NULL,
SNAME VARCHAR2 (10) NOT NULL,
CITY VARCHAR2 (20) NOT NULL
)
PARTITION BY LIST (CITY)
(
PARTITION C1 VALUES ('VARANASI','KOTA'),
PARTITION C2 VALUES ('MUMBAI','DELHI'),
PARTITION C3 VALUES ('PUNE','NAGPUR')
);

DESC STUDENT;

// Q2 //
INSERT INTO STUDENT VALUES ('S31', 'NINAD', 'MUMBAI');
INSERT INTO STUDENT VALUES ('S32', 'ANURAG', 'NAGPUR');
INSERT INTO STUDENT VALUES ('S33', 'ARINDAM', 'VARANASI');
INSERT INTO STUDENT VALUES ('S34', 'ROHIT', 'DELHI');
INSERT INTO STUDENT VALUES ('S35', 'AMEY', 'KOTA');
INSERT INTO STUDENT VALUES ('S36', 'AMIT', 'PUNE');

SELECT * FROM STUDENT;

// Q3 //
SELECT * FROM STUDENT PARTITION(C1);
SELECT * FROM STUDENT PARTITION(C2);
SELECT * FROM STUDENT PARTITION(C3);

// Q4 //
ALTER TABLE STUDENT ADD PARTITION C4 VALUES ('PUNJAB','CHENNAI');

// Q5 //
ALTER TABLE STUDENT RENAME PARTITION C4 TO CI4;

// Q6 //
INSERT INTO STUDENT VALUES ('S37', 'CHINMAY', 'PUNJAB');
SELECT * FROM STUDENT PARTITION (CI4);

// Q7 //
DELETE FROM STUDENT WHERE SNAME='CHINMAY';
SELECT * FROM STUDENT PARTITION (CI4);

// Q8 //
ALTER TABLE STUDENT ADD PARTITION C5 VALUES (DEFAULT);
INSERT INTO STUDENT VALUES ('S38', 'SARATH', 'KERELA');
SELECT * FROM STUDENT PARTITION (C5);

// Q9 //
ALTER TABLE STUDENT MERGE PARTITIONS CI4, C5 INTO PARTITION C6;
SELECT * FROM STUDENT PARTITION (C6);

// Q10 //
ALTER TABLE STUDENT SPLIT PARTITION C6 VALUES ('PUNJAB','CHENNAI') INTO (PARTITION C4, PARTITION C5);
SELECT * FROM STUDENT PARTITION (C4);
SELECT * FROM STUDENT PARTITION (C5);
SELECT * FROM STUDENT;

// Q11 //
ALTER TABLE STUDENT DROP PARTITION C4;
SELECT * FROM STUDENT PARTITION (C4);
SELECT TABLE_NAME,PARTITION_NAME FROM USER_TAB_PARTITIONS WHERE TABLE_NAME='STUDENT';