SET SERVEROUTPUT ON;

// Q1 //
CREATE TABLE EMPLOYEE (
EID VARCHAR2 (10) NOT NULL,
NAME VARCHAR2 (10) NOT NULL,
ADDRESS VARCHAR2 (20) NOT NULL,
SALARY NUMBER (7) NOT NULL
)
PARTITION BY RANGE (SALARY)
(
PARTITION E1 VALUES LESS THAN (20000),
PARTITION E2 VALUES LESS THAN (25000),
PARTITION E3 VALUES LESS THAN (30000)
);

DESC EMPLOYEE;

// Q2 //
INSERT INTO EMPLOYEE VALUES ('E31', 'NINAD', 'CHEMBUR', 28000);
INSERT INTO EMPLOYEE VALUES ('E32', 'ANURAG', 'KURLA', 22000);
INSERT INTO EMPLOYEE VALUES ('E33', 'ARINDAM', 'CHEMBUR', 26000);
INSERT INTO EMPLOYEE VALUES ('E34', 'ROHIT', 'DADAR', 20000);
INSERT INTO EMPLOYEE VALUES ('E35', 'AMEY', 'THANE', 18000);

SELECT * FROM EMPLOYEE;

// Q3 //
SELECT * FROM EMPLOYEE PARTITION(E1);
SELECT * FROM EMPLOYEE PARTITION(E2);
SELECT * FROM EMPLOYEE PARTITION(E3);

// Q4 //
ALTER TABLE EMPLOYEE ADD PARTITION E4 VALUES LESS THAN (MAXVALUE);
INSERT INTO EMPLOYEE VALUES ('E35', 'AMEY', 'THANE', 30000);
SELECT * FROM EMPLOYEE PARTITION (E4);

// Q5 //
ALTER TABLE EMPLOYEE MERGE PARTITIONS E1, E2 INTO PARTITION E10;
SELECT * FROM EMPLOYEE PARTITION (E1);
SELECT * FROM EMPLOYEE PARTITION (E2);
SELECT * FROM EMPLOYEE PARTITION (E10);

// Q6 //
ALTER TABLE EMPLOYEE RENAME PARTITION E10 TO LASTP;
SELECT * FROM EMPLOYEE PARTITION (E10);
SELECT * FROM EMPLOYEE PARTITION (LASTP);

// Q7 //
ALTER TABLE EMPLOYEE SPLIT PARTITION LASTP AT(22000) INTO (PARTITION E1, PARTITION E2);
SELECT * FROM EMPLOYEE;
SELECT * FROM EMPLOYEE PARTITION (E1);
SELECT * FROM EMPLOYEE PARTITION (E2);

// Q8 //
ALTER TABLE EMPLOYEE DROP PARTITION E2;
SELECT * FROM EMPLOYEE;
SELECT * FROM EMPLOYEE PARTITION (E2);
SELECT * FROM EMPLOYEE PARTITION (E1);
